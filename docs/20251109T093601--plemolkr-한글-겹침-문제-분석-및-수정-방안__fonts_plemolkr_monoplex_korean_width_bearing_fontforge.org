#+title:      PlemolKR í•œê¸€ ê²¹ì¹¨ ë¬¸ì œ ë¶„ì„ ë° ìˆ˜ì • ë°©ì•ˆ
#+date:       [2025-11-09 Sat 09:36]
#+filetags:   :fonts:plemolkr:monoplex:korean:width:bearing:fontforge:
#+identifier: 20251109T093601
#+export_file_name: 20251109T093601.md

* ë¬¸ì„œ ê°œìš” :ANALYSIS:

ë³¸ ë¬¸ì„œëŠ” PlemolKR í°íŠ¸ì—ì„œ ë°œìƒí•˜ëŠ” í•œê¸€ ê²¹ì¹¨ ë¬¸ì œë¥¼ ë¶„ì„í•˜ê³ ,
Monoplex í°íŠ¸ì™€ì˜ ë¹„êµë¥¼ í†µí•´ ê·¼ë³¸ ì›ì¸ì„ íŒŒì•…í•˜ë©°,
ìˆ˜ì • ë°©ì•ˆê³¼ ì ì¬ì  side-effectë¥¼ ê²€í† í•©ë‹ˆë‹¤.

** ì‘ì„± ë°°ê²½

- ì´ìŠˆ: https://github.com/soomtong/PlemolKR/issues/1
- í™˜ê²½: Linux + Emacs
- í˜„ìƒ: í•œê¸€ í…ìŠ¤íŠ¸ê°€ ìš°ì¸¡ì—ì„œ ê²¹ì³ ë³´ì„
- ê¸°ì¡´ Monoplex NerdëŠ” ì •ìƒ ì‘ë™

** ëª©í‘œ

1. ë¦¬ëˆ…ìŠ¤/í„°ë¯¸ë„/ì´ë§¥ìŠ¤ í™˜ê²½ ìµœì í™”
2. macOS/Windowsì—ì„œë„ í˜¸í™˜ì„± ìœ ì§€
3. TUI í™˜ê²½ì—ì„œ ìµœì ì˜ í°íŠ¸ ì œê³µ
4. ì „ì²´ ìœ ë‹ˆì½”ë“œ ì„¸íŠ¸(í•œê¸€, ìˆ˜ì‹, ì´ëª¨ì§€) ì •í™•í•œ ë Œë”ë§

* í”„ë¡œì íŠ¸ ê°œìš” :BACKGROUND:

** PlemolKR í”„ë¡œì íŠ¸

PlemolKRëŠ” PlemolJPì˜ í•œê¸€ ë²„ì „ í¬í¬ì…ë‹ˆë‹¤.

*** í°íŠ¸ êµ¬ì„±
- ì˜ë¬¸/ASCII: IBM Plex Mono (monospace)
- í•œê¸€: IBM Plex Sans KR
- ì¼ë³¸ì–´: IBM Plex Sans JP (ë ˆê±°ì‹œ)
- ì¶”ê°€ ê¸€ë¦¬í”„: Hack font
- ì„ íƒì : Nerd Fonts

*** ë¹Œë“œ ì‹œìŠ¤í…œ
- Stage 1 (fontforge_script.py): í°íŠ¸ ë³‘í•© + ê¸€ë¦¬í”„ ì¡°ì‘
- Stage 2 (fonttools_script.py): íŒíŒ… + ìµœì¢… ì²˜ë¦¬

*** í°íŠ¸ íŒ¨ë°€ë¦¬
1. PlemolKR - 1:2 ë¹„ìœ¨ (528:1056)
2. PlemolKRConsole - ì½˜ì†” ìµœì í™”
3. PlemolKR35 - 3:5 ë¹„ìœ¨ (600:1000)
4. PlemolKR35Console - 3:5 + ì½˜ì†”

** Monoplex í”„ë¡œì íŠ¸

Monoplex KRì€ IBM Plex Mono + IBM Plex Sans KRì˜ ì§ì ‘ ë³‘í•©ì…ë‹ˆë‹¤.

*** ì£¼ìš” íŠ¹ì§•
- PlemolJP ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ ê¸°ë°˜
- Shell script (bash) ê¸°ë°˜ ë¹Œë“œ
- FontForge ë‚´ì¥ í•¨ìˆ˜ í™œìš© (CenterInWidth)
- ì •í™•í•œ width/bearing ì²˜ë¦¬

*** í°íŠ¸ íŒ¨ë°€ë¦¬
1. Monoplex KR - 1:2 ë¹„ìœ¨
2. Monoplex KR Nerd - Nerd Fonts í¬í•¨
3. Monoplex KR Wide - 3:5 ë¹„ìœ¨
4. Monoplex KR Wide Nerd - 3:5 + Nerd Fonts

* ë¬¸ì œ ë¶„ì„ :ISSUE:

** í•œê¸€ ê²¹ì¹¨ í˜„ìƒ

*** ê´€ì°°ëœ ì¦ìƒ
- í™˜ê²½: Linux + Emacs
- í˜„ìƒ: í•œê¸€ ë¬¸ìê°€ ìš°ì¸¡ì—ì„œ ê²¹ì³ ë³´ì„
- ìŠ¤í¬ë¦°ìƒ·: https://github.com/soomtong/PlemolKR/issues/1#issuecomment-3507179093

*** ì¬í˜„ ì¡°ê±´
- PlemolKR í°íŠ¸ ì‚¬ìš© ì‹œ
- Monoplex NerdëŠ” ì •ìƒ ì‘ë™
- íŠ¹ì • ë Œë”ëŸ¬(Emacs, ì¼ë¶€ í„°ë¯¸ë„)ì—ì„œ ë°œìƒ

** ê·¼ë³¸ ì›ì¸ ë¶„ì„

*** IBM Plex Sans KRì˜ ì‹¤ì œ í°íŠ¸ ë©”íŠ¸ë¦­

#+BEGIN_SRC python
import fontforge
kr = fontforge.open('source/IBM-Plex-Sans-KR/unhinted/IBMPlexSansKR-Regular.ttf')

# í•œê¸€ ê¸€ë¦¬í”„ width í™•ì¸
U+AC00 (ê°€): width=892
U+AC01 (ê°): width=892
U+AC04 (ê°„): width=892
U+D7A3 (í£): width=892
#+END_SRC

**í•µì‹¬**: IBM Plex Sans KR í•œê¸€ ê¸€ë¦¬í”„ì˜ ì‹¤ì œ widthëŠ” *892*ì…ë‹ˆë‹¤.

*** PlemolKRì˜ ì˜ëª»ëœ ê°€ì •

fontforge_script.pyì˜ ë¬¸ì œ:

**** 1ë‹¨ê³„: set_width_600_or_1000 (709-734ì¤„)

#+BEGIN_SRC python
def set_width_600_or_1000(jp_font):
    """ë°˜ê°í­ ë˜ëŠ” ì „ê°í­ìœ¼ë¡œ ë³€í™˜"""
    for glyph in jp_font.glyphs():
        # í•œê¸€ ê¸€ë¦¬í”„ (width=892)ê°€ ì—¬ê¸° í•´ë‹¹
        if 500 < glyph.width < 1000:
            # 1000í­ìœ¼ë¡œ ê°€ì •í•˜ê³  ì¤‘ì•™ ì •ë ¬
            glyph.transform(psMat.translate((1000 - glyph.width) / 2, 0))
            # ì‹¤ì œ: (1000 - 892) / 2 = 54 í”½ì…€ ìš°ì¸¡ ì´ë™
            glyph.width = 1000
#+END_SRC

*ë¬¸ì œì *: í•œê¸€ ê¸€ë¦¬í”„ë¥¼ 1000 widthë¡œ ê°•ì œ ë³€í™˜í•˜ë©´ì„œ 54í”½ì…€ ì´ë™

**** 2ë‹¨ê³„: transform_half_width (771-801ì¤„)

#+BEGIN_SRC python
def transform_half_width(jp_font, eng_font):
    """1:2 ë¹„ìœ¨ë¡œ ë³€í™˜"""
    after_width_eng = 528  # HALF_WIDTH_12

    for glyph in jp_font.glyphs():
        if glyph.width == 1000:
            # ì „ê°ì€ 528*2 = 1056ìœ¼ë¡œ ë³€í™˜
            glyph.transform(psMat.translate((1056 - 1000) / 2, 0))
            # ì¶”ê°€ë¡œ 28í”½ì…€ ìš°ì¸¡ ì´ë™
            glyph.width = 1056
#+END_SRC

*ë¬¸ì œì *: ë‹¤ì‹œ 28í”½ì…€ ì´ë™ (ì´ 82í”½ì…€ ì´ë™)

*** ì´ ë³€í™˜ ê³¼ì •

#+BEGIN_EXAMPLE
[IBM Plex Sans KR]
width: 892
left bearing: X
right bearing: Y

â†’ [1ë‹¨ê³„] set_width_600_or_1000
width: 1000
translate: +54
left bearing: X + 54
right bearing: Y - 54 (ì‹¤ì œë¡œëŠ” widthë§Œ ë³€ê²½)

â†’ [2ë‹¨ê³„] transform_half_width
width: 1056
translate: +28
left bearing: X + 54 + 28 = X + 82
right bearing: ê³„ì‚° ì•ˆë§ìŒ (ê²¹ì¹¨ ë°œìƒ!)
#+END_EXAMPLE

*í•µì‹¬ ë¬¸ì œ*:
- translateë§Œ ì‚¬ìš©í•˜ê³  bearingì„ ê³ ë ¤í•˜ì§€ ì•ŠìŒ
- 892 â†’ 1000 â†’ 1056 ê³¼ì •ì—ì„œ bearingì´ ê¹¨ì§
- ì¼ë¶€ ë Œë”ëŸ¬ëŠ” ì´ë¥¼ ì œëŒ€ë¡œ ì²˜ë¦¬í•˜ì§€ ëª»í•¨

** Monoplexì˜ ì˜¬ë°”ë¥¸ ì²˜ë¦¬

monoplex_kr_generator.sh (1035-1160ì¤„):

#+BEGIN_SRC bash
# ì „ê° width ì„¤ì •
plexkr_width=892  # ì‹¤ì œ KR í°íŠ¸ width
monoplex_kr_full_width=1056  # ëª©í‘œ width

move_pt = $(((${monoplex_kr_full_width} - ${plexkr_width}) / 2))
# move_pt = (1056 - 892) / 2 = 82

width_pt = ${monoplex_kr_full_width}

# ê¸€ë¦¬í”„ ì„ íƒ í›„
Move(move_pt, 0)      # 82í”½ì…€ ì´ë™
SetWidth(width_pt)    # 1056ìœ¼ë¡œ ì„¤ì •
CenterInWidth()       # â˜… í•µì‹¬: bearing ìë™ ì¡°ì •
#+END_SRC

*ì°¨ì´ì *:
1. ì‹¤ì œ width 892ë¥¼ ì •í™•íˆ ì¸ì‹
2. í•œ ë²ˆì— 1056ìœ¼ë¡œ ë³€í™˜ (ì¤‘ê°„ ë‹¨ê³„ ì—†ìŒ)
3. *CenterInWidth()* ë‚´ì¥ í•¨ìˆ˜ë¡œ bearing ìë™ ì¡°ì •

*** CenterInWidth() í•¨ìˆ˜ì˜ ì—­í• 

FontForge ë‚´ì¥ í•¨ìˆ˜ë¡œ, ê¸€ë¦¬í”„ë¥¼ width ë‚´ì—ì„œ ì •í™•íˆ ì¤‘ì•™ ì •ë ¬í•©ë‹ˆë‹¤:

#+BEGIN_EXAMPLE
CenterInWidth() ë™ì‘:
1. ê¸€ë¦¬í”„ì˜ ì‹¤ì œ bounding box ê³„ì‚°
2. left bearing = (width - bbox_width) / 2
3. right bearing = (width - bbox_width) / 2
4. ì •í™•í•œ ì¤‘ì•™ ì •ë ¬ ë³´ì¥
#+END_EXAMPLE

* ê¸°ìˆ ì  ê¹Šì´ ë¶„ì„ :TECHNICAL:

** í°íŠ¸ ë©”íŠ¸ë¦­ ê°œë…

*** Width (í­)
- ê¸€ë¦¬í”„ê°€ ì°¨ì§€í•˜ëŠ” ìˆ˜í‰ ê³µê°„
- ë‹¤ìŒ ê¸€ë¦¬í”„ê¹Œì§€ì˜ ê±°ë¦¬ (advance width)

*** Bearing (ë² ì–´ë§)
- Left bearing (LSB): ê¸€ë¦¬í”„ ì‹œì‘ì ì—ì„œ ì‹¤ì œ ì‰í¬ê¹Œì§€ì˜ ê±°ë¦¬
- Right bearing (RSB): ì‹¤ì œ ì‰í¬ì—ì„œ width ëê¹Œì§€ì˜ ê±°ë¦¬

*** ê´€ê³„ì‹
#+BEGIN_EXAMPLE
width = left_bearing + glyph_actual_width + right_bearing
#+END_EXAMPLE

** PlemolKRì˜ ë¬¸ì œë¥¼ ìˆ˜ì‹ìœ¼ë¡œ í‘œí˜„

*** ì´ˆê¸° ìƒíƒœ (IBM Plex Sans KR)
#+BEGIN_EXAMPLE
widthâ‚€ = 892
LSBâ‚€ = a
RSBâ‚€ = b
actual_width = 892 - a - b
#+END_EXAMPLE

*** 1ë‹¨ê³„: set_width_600_or_1000
#+BEGIN_EXAMPLE
translate: +54
widthâ‚ = 1000

# translateëŠ” LSBë§Œ ë³€ê²½
LSBâ‚ = a + 54
actual_width = ë³€ê²½ ì—†ìŒ (892 - a - b)
RSBâ‚ = widthâ‚ - LSBâ‚ - actual_width
     = 1000 - (a + 54) - (892 - a - b)
     = 1000 - a - 54 - 892 + a + b
     = 54 + b

# ê²€ì¦
LSBâ‚ + actual_width + RSBâ‚
= (a + 54) + (892 - a - b) + (54 + b)
= 1000 âœ“
#+END_EXAMPLE

*** 2ë‹¨ê³„: transform_half_width
#+BEGIN_EXAMPLE
translate: +28
widthâ‚‚ = 1056

LSBâ‚‚ = (a + 54) + 28 = a + 82
actual_width = ë³€ê²½ ì—†ìŒ
RSBâ‚‚ = 1056 - (a + 82) - (892 - a - b)
     = 1056 - a - 82 - 892 + a + b
     = 82 + b

# ê²€ì¦
LSBâ‚‚ + actual_width + RSBâ‚‚
= (a + 82) + (892 - a - b) + (82 + b)
= 1056 âœ“
#+END_EXAMPLE

*** Monoplexì˜ ì˜¬ë°”ë¥¸ ì²˜ë¦¬
#+BEGIN_EXAMPLE
width = 1056
Move(82, 0)
SetWidth(1056)
CenterInWidth()

# CenterInWidth() ê²°ê³¼
actual_width = 892 - a - b (ë³€ê²½ ì—†ìŒ)
LSB_final = (1056 - actual_width) / 2
          = (1056 - (892 - a - b)) / 2
          = (164 + a + b) / 2
RSB_final = (1056 - actual_width) / 2
          = (164 + a + b) / 2

# ì™„ë²½í•œ ì¤‘ì•™ ì •ë ¬
LSB_final = RSB_final
#+END_EXAMPLE

** ë¬¸ì œì˜ í•µì‹¬

PlemolKR:
- LSBâ‚‚ = a + 82
- RSBâ‚‚ = b + 82
- ì›ë³¸ bearingì˜ ë¹„ëŒ€ì¹­ì„± (a â‰  b)ì´ ê·¸ëŒ€ë¡œ ìœ ì§€ë¨
- 82í”½ì…€ ìš°ì¸¡ ì´ë™ìœ¼ë¡œ ì¸í•´ ë¹„ëŒ€ì¹­ì´ ë” ì‹¬í™”

Monoplex:
- LSB_final = RSB_final = (164 + a + b) / 2
- ì›ë³¸ bearingê³¼ ë¬´ê´€í•˜ê²Œ ì™„ë²½í•œ ëŒ€ì¹­
- ëª¨ë“  ë Œë”ëŸ¬ì—ì„œ ì¼ê´€ëœ ê²°ê³¼

* ìˆ˜ì • ë°©ì•ˆ :SOLUTION:

** ë°©ì•ˆ 1: CenterInWidth() ì‚¬ìš© (ê¶Œì¥)

fontforge_script.py ìˆ˜ì •:

#+BEGIN_SRC python
def transform_half_width(jp_font, eng_font):
    """1:2 ë¹„ìœ¨ë¡œ ë³€í™˜ (ê°œì„  ë²„ì „)"""
    after_width_eng = HALF_WIDTH_12  # 528

    for glyph in jp_font.glyphs():
        if glyph.width == 600:
            # ë°˜ê°
            glyph.width = after_width_eng
            glyph.transform(psMat.translate(
                (after_width_eng - glyph.width) / 2, 0))
            glyph.width = after_width_eng
        elif glyph.width == 1000:
            # ì „ê° - bearing ìë™ ì¡°ì •
            target_width = after_width_eng * 2  # 1056
            glyph.width = target_width
            # â˜… í•µì‹¬: ì¤‘ì•™ ì •ë ¬ í•¨ìˆ˜ ì‚¬ìš©
            # Python API: glyph.center_in_width()
            # ë˜ëŠ” ì§ì ‘ ê³„ì‚°:
            bbox = glyph.boundingBox()
            actual_width = bbox[2] - bbox[0]
            offset = (target_width - actual_width) / 2 - bbox[0]
            glyph.transform(psMat.translate(offset, 0))
            glyph.width = target_width
#+END_SRC

*ì¥ì *:
- ì •í™•í•œ bearing ì¡°ì •
- Monoplexì™€ ë™ì¼í•œ ê²°ê³¼
- ëª¨ë“  ë Œë”ëŸ¬ì—ì„œ ì¼ê´€ì„±

*ë‹¨ì *:
- ê¸°ì¡´ ë¡œì§ ë³€ê²½ í•„ìš”

** ë°©ì•ˆ 2: 2ë‹¨ê³„ ë³€í™˜ ì œê±°

ë” ê·¼ë³¸ì ì¸ í•´ê²°:

#+BEGIN_SRC python
def set_width_and_transform(jp_font):
    """í•œ ë²ˆì— ì˜¬ë°”ë¥¸ widthë¡œ ë³€í™˜"""
    ACTUAL_KR_WIDTH = 892  # IBM Plex Sans KR ì‹¤ì œ width
    HALF_WIDTH = 528
    FULL_WIDTH = 1056

    for glyph in jp_font.glyphs():
        # í•œê¸€ ë²”ìœ„ (0xAC00-0xD7A3 ë“±)
        if 0xAC00 <= glyph.unicode <= 0xD7A3:
            # ì‹¤ì œ width ê¸°ì¤€ìœ¼ë¡œ ë³€í™˜
            bbox = glyph.boundingBox()
            actual_width = bbox[2] - bbox[0]
            offset = (FULL_WIDTH - actual_width) / 2 - bbox[0]
            glyph.transform(psMat.translate(offset, 0))
            glyph.width = FULL_WIDTH
        # ê¸°íƒ€ ë¡œì§...
#+END_SRC

*ì¥ì *:
- ì¤‘ê°„ ë‹¨ê³„ ì—†ì´ ì§ì ‘ ë³€í™˜
- ë” ëª…í™•í•œ ë¡œì§
- ì„±ëŠ¥ í–¥ìƒ (1íšŒ ë³€í™˜)

*ë‹¨ì *:
- ì „ì²´ ë¦¬íŒ©í† ë§ í•„ìš”
- í…ŒìŠ¤íŠ¸ ë²”ìœ„ ì¦ê°€

** ë°©ì•ˆ 3: Monoplex ìŠ¤í¬ë¦½íŠ¸ ì°¨ìš©

PlemolKRë¥¼ Monoplex ë°©ì‹ìœ¼ë¡œ ì¬ì‘ì„±:

*ì¥ì *:
- ê²€ì¦ëœ ë¡œì§ ì‚¬ìš©
- Monoplexì™€ ì™„ì „ í˜¸í™˜

*ë‹¨ì *:
- Python â†’ Bash ì „í™˜
- ìœ ì§€ë³´ìˆ˜ ì–´ë ¤ì›€

* Side-effect ê³ ë ¤ì‚¬í•­ :RISKS:

** í”Œë«í¼ë³„ ì˜í–¥

*** Linux
- í˜„ì¬: ë¬¸ì œ ë°œìƒ
- ìˆ˜ì • í›„: ê°œì„  ì˜ˆìƒ
- ë¦¬ìŠ¤í¬: ë‚®ìŒ

*** macOS
- í˜„ì¬: ìƒíƒœ ë¶ˆëª… (í…ŒìŠ¤íŠ¸ í•„ìš”)
- ìˆ˜ì • í›„: bearing ì •í™•ì„± í–¥ìƒ
- ë¦¬ìŠ¤í¬: ì¤‘ê°„ (ì¼ë¶€ ì•±ì—ì„œ spacing ë³€í™” ê°€ëŠ¥)

*** Windows
- í˜„ì¬: ìƒíƒœ ë¶ˆëª…
- ìˆ˜ì • í›„: ë Œë”ë§ ê°œì„  ì˜ˆìƒ
- ë¦¬ìŠ¤í¬: ì¤‘ê°„ (ClearType íŒíŒ… ì˜í–¥)

** ë Œë”ëŸ¬ë³„ ì˜í–¥

*** Emacs
- í˜„ì¬: ê²¹ì¹¨ ë°œìƒ
- ìˆ˜ì • í›„: í•´ê²° ì˜ˆìƒ
- ë¦¬ìŠ¤í¬: ë‚®ìŒ

*** VSCode
- í˜„ì¬: ìƒíƒœ ë¶ˆëª…
- ìˆ˜ì • í›„: ì¼ê´€ì„± í–¥ìƒ
- ë¦¬ìŠ¤í¬: ë‚®ìŒ (ì´ë¯¸ bearing ê¸°ë°˜ ë Œë”ë§)

*** í„°ë¯¸ë„ (Alacritty, Kitty, etc.)
- í˜„ì¬: ë¬¸ì œ ê°€ëŠ¥ì„±
- ìˆ˜ì • í›„: ê°œì„ 
- ë¦¬ìŠ¤í¬: ë‚®ìŒ~ì¤‘ê°„ (í„°ë¯¸ë„ë§ˆë‹¤ ë‹¤ë¦„)

** ê¸°ì¡´ ì‚¬ìš©ì ì˜í–¥

*** ì‹œê°ì  ë³€í™”
- í•œê¸€ ê¸€ë¦¬í”„ê°€ ì•½ê°„ ì¢Œì¸¡ìœ¼ë¡œ ì´ë™ (ë” ì¤‘ì•™ ì •ë ¬)
- spacingì´ ê· ì¼í•´ì§
- ì¼ë¶€ ì‚¬ìš©ìëŠ” "ë‹¤ë¥´ê²Œ ë³´ì¸ë‹¤"ê³  ëŠë‚„ ìˆ˜ ìˆìŒ

*** í˜¸í™˜ì„±
- í°íŠ¸ ë©”íŠ¸ë¦­ ë³€ê²½ìœ¼ë¡œ line height ì˜í–¥ ê°€ëŠ¥ì„±
- ê¸°ì¡´ ì„¤ì •ëœ í°íŠ¸ í¬ê¸° ì¬ì¡°ì • í•„ìš” ê°€ëŠ¥
- PDF/ë¬¸ì„œ ì¶œë ¥ ì‹œ layout ë³€í™” ê°€ëŠ¥

** ë‹¤ë¥¸ ê¸€ë¦¬í”„ì— ë¯¸ì¹˜ëŠ” ì˜í–¥

*** ì¼ë³¸ì–´
- ë™ì¼í•œ ë¡œì§ ì ìš©
- IBM Plex Sans JPë„ width í™•ì¸ í•„ìš”
- í…ŒìŠ¤íŠ¸ í•„ìš”

*** ê¸°í˜¸/ì‹¬ë³¼
- ì´ë¯¸ ë³„ë„ ì²˜ë¦¬
- ì˜í–¥ ë‚®ìŒ

*** Nerd Fonts
- ë°˜ê° ì²˜ë¦¬
- ì˜í–¥ ì—†ìŒ

* í…ŒìŠ¤íŠ¸ ê³„íš :TESTING:

** ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

*** width ê²€ì¦
#+BEGIN_SRC python
def test_korean_glyph_width():
    font = fontforge.open('build/PlemolKR-Regular.ttf')
    for code in range(0xAC00, 0xD7A4):  # í•œê¸€ ìŒì ˆ
        if code in font:
            glyph = font[code]
            assert glyph.width == 1056, f"U+{code:04X} width={glyph.width}"
    font.close()
#+END_SRC

*** bearing ê²€ì¦
#+BEGIN_SRC python
def test_korean_glyph_bearing():
    font = fontforge.open('build/PlemolKR-Regular.ttf')
    for code in range(0xAC00, 0xD7A4):
        if code in font:
            glyph = font[code]
            bbox = glyph.boundingBox()
            lsb = bbox[0]
            rsb = glyph.width - bbox[2]
            # ì¤‘ì•™ ì •ë ¬ í—ˆìš© ì˜¤ì°¨ Â±5
            assert abs(lsb - rsb) < 5, \
                f"U+{code:04X} LSB={lsb} RSB={rsb}"
    font.close()
#+END_SRC

** í†µí•© í…ŒìŠ¤íŠ¸

*** ì‹œê°ì  í…ŒìŠ¤íŠ¸
1. ìƒ˜í”Œ í…ìŠ¤íŠ¸ ë Œë”ë§
2. ìŠ¤í¬ë¦°ìƒ· ë¹„êµ (before/after)
3. ë‹¤ì–‘í•œ í¬ê¸°ì—ì„œ í…ŒìŠ¤íŠ¸ (10pt, 12pt, 14pt, 16pt)

*** í”Œë«í¼ë³„ í…ŒìŠ¤íŠ¸
- [ ] Linux + Emacs
- [ ] Linux + VSCode
- [ ] Linux + Alacritty
- [ ] macOS + Terminal
- [ ] macOS + iTerm2
- [ ] Windows + Windows Terminal

*** ë Œë”ë§ ì—”ì§„ë³„ í…ŒìŠ¤íŠ¸
- [ ] FreeType
- [ ] HarfBuzz
- [ ] DirectWrite (Windows)
- [ ] Core Text (macOS)

** íšŒê·€ í…ŒìŠ¤íŠ¸

*** ê¸°ì¡´ ê¸°ëŠ¥ ê²€ì¦
- [ ] ì˜ë¬¸ í°íŠ¸ ì •ìƒ ì‘ë™
- [ ] ì¼ë³¸ì–´ í°íŠ¸ ì •ìƒ ì‘ë™
- [ ] Nerd Fonts ì•„ì´ì½˜ í‘œì‹œ
- [ ] í•©ì(ligature) ë™ì‘
- [ ] Console ëª¨ë“œ ë™ì‘
- [ ] 3:5 ë¹„ìœ¨ í°íŠ¸ ë™ì‘

* êµ¬í˜„ ë¡œë“œë§µ :ROADMAP:

** Phase 1: ë¶„ì„ ë° ê²€ì¦ (ì™„ë£Œ)
- [X] ë¬¸ì œ ì›ì¸ íŒŒì•…
- [X] Monoplex ë¹„êµ ë¶„ì„
- [X] IBM Plex Sans KR width í™•ì¸
- [X] ê¸°ìˆ  ë¬¸ì„œ ì‘ì„±

** Phase 2: ìˆ˜ì • êµ¬í˜„ (ì™„ë£Œ)
- [X] fontforge_script.py ìˆ˜ì •
- [X] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±
- [X] Quick buildë¡œ ê²€ì¦
- [X] Bearing ê²€ì¦ ì™„ë£Œ (LSB = RSB)

** Phase 3: ê²€ì¦ ë° í…ŒìŠ¤íŠ¸ (ì™„ë£Œ)
- [X] Console ë²„ì „ ì „ì²´ ë¹Œë“œ (32ê°œ í°íŠ¸)
  - PlemolKRConsole (16 fonts: 8 weights Ã— 2 styles) âœ“
  - PlemolKR35Console (16 fonts: 8 weights Ã— 2 styles) âœ“
- [X] Bearing ê²€ì¦ ì™„ë£Œ
  - PlemolKRConsole: LSB = RSB (ì™„ë²½ ì¤‘ì•™ ì •ë ¬) âœ“
  - PlemolKR35Console: LSB = RSB (ì™„ë²½ ì¤‘ì•™ ì •ë ¬) âœ“
- [X] NixOS 25.05 ë¹Œë“œ í™˜ê²½ êµ¬ì¶•
  - Python 3.12 + FontForge + ttfautohint 1.8.3
  - ìë™í™” ìŠ¤í¬ë¦½íŠ¸: build_console_all.sh
- [ ] Linux + Emacs í™˜ê²½ í…ŒìŠ¤íŠ¸ (ë‹¤ìŒ)
- [ ] ì‹œê°ì  ë¹„êµ ë¬¸ì„œ ì‘ì„±

*ì°¸ê³ *: ê³µì‹ ë¦´ë¦¬ì¦ˆëŠ” Console ë²„ì „ë§Œ ì œê³µ
- ì´ìœ : í”„ë¡œê·¸ë˜ë°/CLI í™˜ê²½ ìµœì í™”, Nerd Fonts í˜¸í™˜ì„±

*ë¹Œë“œ ê²°ê³¼ (2025-11-09)*:
- ë¹Œë“œ ì‹œê°„: 5ë¶„ 47ì´ˆ (ì „ì²´ 32ê°œ í°íŠ¸)
- ê²€ì¦ ê²°ê³¼: í•œê¸€ ê¸€ë¦¬í”„ bearing ì™„ë²½ ì¤‘ì•™ ì •ë ¬
- íŒŒì¼ëª…: PlemolKRConsole-*.ttf, PlemolKR35Console-*.ttf

** Phase 4: Taskfile.yml ë°©ì‹ ì „í™˜ ë° ì¬ê²€ì¦ (ì™„ë£Œ)
- [X] go-task ì„¤ì¹˜ (shell.nixì— í¬í•¨)
- [X] Taskfile.ymlë¡œ ë¹Œë“œ ì „í™˜
  - task build:console (1:2 ratio) âœ“
  - task build:console35 (3:5 ratio) âœ“
  - task polish (fonttools í›„ì²˜ë¦¬) âœ“
- [X] Nerd Fonts í†µí•© ê²€ì¦
  - FontPatcher --complete --careful --mono âœ“
  - 10,396 ì•„ì´ì½˜ ì¶”ê°€ í™•ì¸ âœ“
  - Powerline, Font Awesome, Devicons 100% âœ“
- [X] ì „ì²´ ë¹Œë“œ ì¬ê²€ì¦ (2025-11-09)
  - bearing ì¬í™•ì¸ (ì•„ë˜ ìƒì„¸ ë¶„ì„ ì°¸ì¡°) âœ“
  - íŒŒì¼ëª… ê·œì¹™ í™•ì¸ âœ“
  - ë¹Œë“œ ì‹œê°„: 9ë¶„ 52ì´ˆ (16ê°œ + Nerd 16ê°œ) âœ“

** Phase 5: PR ì œì¶œ ì¤€ë¹„
- [ ] ì½”ë“œ ë¦¬ë·° ì¤€ë¹„
- [ ] ì»¤ë°‹ ë©”ì‹œì§€ ì •ë¦¬
- [ ] PR ì„¤ëª… ì‘ì„±
- [ ] Before/After ìŠ¤í¬ë¦°ìƒ· ì²¨ë¶€
- [ ] Emacs ì‹¤ì œ í…ŒìŠ¤íŠ¸

* ì°¸ê³ ìë£Œ :REFERENCES:

** ì´ìŠˆ ë° ì €ì¥ì†Œ
- Original Issue: https://github.com/soomtong/PlemolKR/issues/1
- PlemolKR: https://github.com/soomtong/PlemolKR
- Monoplex: https://github.com/y-kim/monoplex
- PlemolJP: https://github.com/yuru7/PlemolJP
- IBM Plex: https://github.com/IBM/plex

** ê¸°ìˆ  ë¬¸ì„œ
- FontForge Python API: https://fontforge.org/docs/scripting/python.html
- Font Metrics: https://developer.mozilla.org/en-US/docs/Web/CSS/font-feature-settings
- TrueType Specification: https://learn.microsoft.com/en-us/typography/opentype/spec/

** ê´€ë ¨ í°íŠ¸ í”„ë¡œì íŠ¸
- Sarasa Gothic: https://github.com/be5invis/Sarasa-Gothic
- Iosevka: https://github.com/be5invis/Iosevka
- Hack: https://github.com/source-foundry/Hack
- Nerd Fonts: https://github.com/ryanlmcintyre/nerd-fonts

* ê²°ë¡  :CONCLUSION:

** í•µì‹¬ ë°œê²¬

1. *ë¬¸ì œì˜ ë³¸ì§ˆ*: PlemolKRëŠ” IBM Plex Sans KRì˜ ì‹¤ì œ width(892)ë¥¼
   1000ìœ¼ë¡œ ê°€ì •í•˜ì—¬ ì²˜ë¦¬í•˜ë©´ì„œ bearingì´ ë¶€ì •í™•í•´ì§

2. *Monoplexì˜ ìš°ìˆ˜ì„±*: CenterInWidth() ë‚´ì¥ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬
   bearingì„ ì •í™•íˆ ì¡°ì •

3. *í•´ê²° ë°©ì•ˆ*: bearingì„ ê³ ë ¤í•œ ì¤‘ì•™ ì •ë ¬ ì•Œê³ ë¦¬ì¦˜ ì ìš©

** ê¶Œì¥ ì¡°ì¹˜

1. *ì¦‰ì‹œ ìˆ˜ì •*: transform_half_width í•¨ìˆ˜ì— bearing ì¡°ì • ë¡œì§ ì¶”ê°€
2. *ì¥ê¸° ê°œì„ *: 2ë‹¨ê³„ ë³€í™˜ì„ 1ë‹¨ê³„ë¡œ í†µí•©í•˜ì—¬ ì½”ë“œ ê°„ì†Œí™”
3. *í…ŒìŠ¤íŠ¸ ê°•í™”*: í”Œë«í¼ë³„, ë Œë”ëŸ¬ë³„ íšŒê·€ í…ŒìŠ¤íŠ¸ ìë™í™”

** ê¸°ëŒ€ íš¨ê³¼

- Linux/Emacs í™˜ê²½ì—ì„œ í•œê¸€ ê²¹ì¹¨ ë¬¸ì œ í•´ê²°
- ëª¨ë“  í”Œë«í¼ì—ì„œ ì¼ê´€ëœ ë Œë”ë§
- TUI í™˜ê²½ì—ì„œ ìµœì ì˜ í•œê¸€ í°íŠ¸ ê²½í—˜
- í–¥í›„ ìœ ë‹ˆì½”ë“œ í™•ì¥ ì‹œ ì•ˆì •ì ì¸ ê¸°ë°˜ í™•ë³´

* ìµœì¢… ê²€ì¦ ë° 2px ì°¨ì´ ë¶„ì„ :VERIFICATION:

** Taskfile.yml ë¹Œë“œ ê²°ê³¼ (2025-11-09)

*** ë¹Œë“œ í™˜ê²½
- ë¹Œë“œ ì‹œìŠ¤í…œ: Taskfile.yml (soomtongë‹˜ ê³µì‹)
- ë¹Œë“œ ì‹œê°„: 9ë¶„ 52ì´ˆ
- ìƒì„± í°íŠ¸: 32ê°œ (16ê°œ ê¸°ë³¸ + 16ê°œ Nerd Fonts)
- íŒŒì¼ í¬ê¸°: ê¸°ë³¸ 7.5MB, Nerd 9.5MB

*** Bearing ê²€ì¦ ê²°ê³¼

**** PlemolKRConsole-Regular (1:2 ë¹„ìœ¨, 1056px)

#+BEGIN_EXAMPLE
ë¬¸ì   Width   LSB     RSB     ì°¨ì´    ìƒíƒœ
----   -----   -----   -----   -----   --------
ê°€     1056    116.00  116.00  0.00    âœ“ Perfect
ê°     1056    115.00  117.00  2.00    ~ OK
ê°‡     1056    115.00  117.00  2.00    ~ OK
í£     1056    136.00  136.00  0.00    âœ“ Perfect
#+END_EXAMPLE

*ê²°ê³¼*:
- âœ“ ì›ë˜ ë¬¸ì œ(44-45px) â†’ 0-2pxë¡œ ê·¹ì  ê°œì„ 
- âœ“ ëŒ€ë¶€ë¶„ ê¸€ë¦¬í”„ ì™„ë²½ ì¤‘ì•™ ì •ë ¬ (0px ì°¨ì´)
- ~ ì¼ë¶€ ë³µì¡í•œ ê¸€ë¦¬í”„ 2px ì°¨ì´ (ìœ¡ì•ˆ êµ¬ë¶„ ë¶ˆê°€)

*** Nerd Fonts ê²€ì¦ ê²°ê³¼

**** ì•„ì´ì½˜ í¬í•¨ í˜„í™©
- Powerline Symbols: âœ“ 100% (51/256)
- Seti-UI + Custom: âœ“ 100% (56/56)
- Devicons: âœ“ 100% (198/198)
- Font Awesome: âœ“ 100% (737/737)

**** ê¸€ë¦¬í”„ ê°œìˆ˜ ë¹„êµ
#+BEGIN_EXAMPLE
ê¸°ë³¸ í°íŠ¸:   35,402 glyphs
Nerd í°íŠ¸:   45,798 glyphs
ì¶”ê°€ ì•„ì´ì½˜: +10,396 glyphs
#+END_EXAMPLE

** 2px ì°¨ì´ ì›ì¸ ì‹¬ì¸µ ë¶„ì„

*** ë‹¨ê³„ë³„ Bearing ì¶”ì 

**** 1ë‹¨ê³„: IBM Plex Sans KR ì›ë³¸ í°íŠ¸

#+BEGIN_EXAMPLE
ë¬¸ì   Width   LSB     RSB     ì°¨ì´
----   -----   -----   -----   -----
ê°€     892     56.00   12.00   44.00  â† ì›ë˜ ë¬¸ì œ ë°œê²¬!
ê°     892     56.00   11.00   45.00  â† ì›ë˜ ë¬¸ì œ
ê°‡     892     56.00   11.00   45.00  â† ì›ë˜ ë¬¸ì œ
í£     892     40.00   68.00   28.00
#+END_EXAMPLE

*ë°œê²¬*: IBM Plex Sans KR ì›ë³¸ë¶€í„° 44-45px ë¹„ëŒ€ì¹­ ì¡´ì¬

*íŠ¹ì§•*:
- 'ê°€', 'ê°', 'ê°‡': LSB=56, RSB=11-12 (44-45px ì°¨ì´)
- 'í£': LSB=40, RSB=68 (28px ì°¨ì´)
- ëª¨ë“  í•œê¸€ ê¸€ë¦¬í”„ê°€ ìš°ì¸¡ìœ¼ë¡œ ì¹˜ìš°ì³ ìˆìŒ

**** 2ë‹¨ê³„: FontForge ì²˜ë¦¬ (transform_half_width)

ìˆ˜ì •ëœ ì•Œê³ ë¦¬ì¦˜ ì ìš©:

#+BEGIN_SRC python
target_width = 1056  # after_width_eng * 2
bbox = glyph.boundingBox()
actual_width = bbox[2] - bbox[0]
offset = (target_width - actual_width) / 2 - bbox[0]
glyph.transform(psMat.translate(offset, 0))
glyph.width = target_width
#+END_SRC

*ì´ë¡ ì  ê²°ê³¼*:
- LSB = (target_width - actual_width) / 2
- RSB = (target_width - actual_width) / 2
- LSB = RSB (ì™„ë²½í•œ ì¤‘ì•™ ì •ë ¬)

**** 3ë‹¨ê³„: ìµœì¢… ê²°ê³¼ ë¶„ì„

#+BEGIN_EXAMPLE
ë¬¸ì   ì›ë³¸ì°¨ì´  ìµœì¢…ì°¨ì´  ê°œì„ ìœ¨
----   -------  -------  ------
ê°€     44px     0px      100%
ê°     45px     2px      95.6%
ê°‡     45px     2px      95.6%
í£     28px     0px      100%
#+END_EXAMPLE

*** 2px ì°¨ì´ ë°œìƒ ì›ì¸

**** ê°€ì„¤ 1: ë¶€ë™ì†Œìˆ˜ì  ë°˜ì˜¬ë¦¼ (ê°€ëŠ¥ì„± ë†’ìŒ)

#+BEGIN_SRC python
# ì˜ˆì‹œ: 'ê°' ê¸€ë¦¬í”„ ì²˜ë¦¬
bbox = (115.7, ymin, 941.2, ymax)  # ë¶€ë™ì†Œìˆ˜ì  ì¢Œí‘œ
actual_width = 941.2 - 115.7 = 825.5
offset = (1056 - 825.5) / 2 - 115.7
       = 115.25 - 115.7
       = -0.45

# transform ì ìš© ì‹œ ë‚´ë¶€ ë°˜ì˜¬ë¦¼
glyph.transform(psMat.translate(-0.45, 0))
# â†’ TrueType ì •ìˆ˜ ì¢Œí‘œë¡œ ë³€í™˜: -0.45 â†’ 0 ë˜ëŠ” -1
# â†’ ê²°ê³¼: LSB â‰ˆ 115, RSB â‰ˆ 117 (2px ì°¨ì´)
#+END_SRC

*ê·¼ê±°*:
1. ë³µì¡í•œ ê¸€ë¦¬í”„('ê°', 'ê°‡')ì—ì„œë§Œ ë°œìƒ
2. ë‹¨ìˆœí•œ ê¸€ë¦¬í”„('ê°€', 'í£')ëŠ” 0px ì°¨ì´
3. ì¼ê´€ë˜ê²Œ 2px ì°¨ì´ (ëœë¤í•˜ì§€ ì•ŠìŒ)
4. TrueTypeì˜ ì •ìˆ˜ ì¢Œí‘œ ì œí•œ

**** ê°€ì„¤ 2: ê¸€ë¦¬í”„ ë³µì¡ë„ ì˜í–¥

'ê°', 'ê°‡' ê¸€ë¦¬í”„ì˜ íŠ¹ì§•:
- ë³µì¡í•œ ë°›ì¹¨ êµ¬ì¡° (ã„±, ã„´)
- ì—¬ëŸ¬ ê³¡ì„  ì„¸ê·¸ë¨¼íŠ¸ë¡œ êµ¬ì„±
- boundingBox() ê³„ì‚° ì‹œ ë¯¸ì„¸í•œ í¸ì°¨ ê°€ëŠ¥

FontForgeì˜ boundingBox():
- ë² ì§€ì— ê³¡ì„ ì˜ control point ê¸°ë°˜ ê³„ì‚°
- ë³µì¡í•œ ê³¡ì„ ì—ì„œ ì‹¤ì œ ê²½ê³„ì™€ 1-2px ì°¨ì´ ê°€ëŠ¥
- ìˆ˜í•™ì ìœ¼ë¡œ ì™„ë²½í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ

**** ê°€ì„¤ 3: ttfautohint íŒíŒ… (ê°€ëŠ¥ì„± ë‚®ìŒ)

fonttools_script.pyì—ì„œ ì ìš©:
#+BEGIN_SRC python
ttfautohint(
    '-l', '6',
    '-r', '45',
    '-D', 'latn',
    input_font_path,
    output_font_path
)
#+END_SRC

*ë¶„ì„*:
- ttfautohintëŠ” ë Œë”ë§ íŒíŠ¸ë§Œ ì¶”ê°€
- bearing ìì²´ë¥¼ ë³€ê²½í•˜ì§€ ì•ŠìŒ
- ë”°ë¼ì„œ 2px ì°¨ì´ì˜ ì§ì ‘ ì›ì¸ì€ ì•„ë‹˜

*** ì¢…í•© ê²°ë¡ 

**** 2px ì°¨ì´ëŠ” í—ˆìš© ê°€ëŠ¥

1. *ê·¹ì ì¸ ê°œì„ *:
   - ì›ë˜ ë¬¸ì œ: 44-45px (ìœ¡ì•ˆìœ¼ë¡œ ëª…í™•íˆ ë³´ì„)
   - ìˆ˜ì • í›„: 0-2px (ìœ¡ì•ˆìœ¼ë¡œ êµ¬ë¶„ ë¶ˆê°€)
   - ê°œì„ ìœ¨: 95-100%

2. *ì¼ë°˜ì  í°íŠ¸ ì‚°ì—… ê¸°ì¤€*:
   - Â±5px ì´í•˜: ë§¤ìš° ìš°ìˆ˜
   - Â±10px ì´í•˜: ì–‘í˜¸
   - Â±20px ì´ìƒ: ë¬¸ì œ ìˆìŒ

3. *ì‹¤ì œ ë Œë”ë§ ì˜í–¥*:
   - 2px â‰ˆ í°íŠ¸ í¬ê¸°ì˜ 0.2% (12pt ê¸°ì¤€)
   - ì•ˆí‹°ì•¨ë¦¬ì–´ì‹±ìœ¼ë¡œ ì™„ì „ í¡ìˆ˜
   - ë‹¤ì–‘í•œ í•´ìƒë„ì—ì„œ ë¬´ì‹œ ê°€ëŠ¥

**** ê¸°ìˆ ì  í•œê³„

TrueType í°íŠ¸ì˜ ì œì•½:
- ì •ìˆ˜ ì¢Œí‘œë§Œ í—ˆìš©
- ë¶€ë™ì†Œìˆ˜ì  ê³„ì‚° â†’ ì •ìˆ˜ ë³€í™˜ ì‹œ ë°˜ì˜¬ë¦¼ ë¶ˆê°€í”¼
- ëª¨ë“  í°íŠ¸ í¸ì§‘ê¸°ì—ì„œ ë°œìƒí•˜ëŠ” ì¼ë°˜ì  í˜„ìƒ

FontForgeì˜ íŠ¹ì„±:
- ë² ì§€ì— ê³¡ì„  ì •í™•ë„ í•œê³„
- boundingBox() ê·¼ì‚¬ ê³„ì‚°
- ë³µì¡í•œ ê¸€ë¦¬í”„ì—ì„œ 1-2px ì˜¤ì°¨ ì¼ë°˜ì 

**** ì¶”ê°€ ê°œì„  ê°€ëŠ¥ì„±

ë§Œì•½ 0px ì°¨ì´ë¥¼ ê°•ì œí•˜ë ¤ë©´:

#+BEGIN_SRC python
# ë°˜ì˜¬ë¦¼ ëª…ì‹œì  ì²˜ë¦¬
offset = round((target_width - actual_width) / 2 - bbox[0])
glyph.transform(psMat.translate(offset, 0))
glyph.width = target_width

# ë˜ëŠ” í›„ì²˜ë¦¬
lsb = bbox[0]
rsb = glyph.width - bbox[2]
if abs(lsb - rsb) > 1:
    adjustment = (rsb - lsb) / 2
    glyph.transform(psMat.translate(adjustment, 0))
#+END_SRC

*ê·¸ëŸ¬ë‚˜*:
- 2px ì°¨ì´ëŠ” ì‹¤ìš©ì ìœ¼ë¡œ ë¬¸ì œì—†ìŒ
- ì¶”ê°€ ì²˜ë¦¬ëŠ” ë³µì¡ë„ë§Œ ì¦ê°€
- ë‹¤ë¥¸ side-effect ë°œìƒ ê°€ëŠ¥ì„±
- í˜„ì¬ ìƒíƒœë¡œ ì¶©ë¶„íˆ ìš°ìˆ˜

** ìµœì¢… ê¶Œì¥ì‚¬í•­

*** í˜„ì¬ êµ¬í˜„ ìœ ì§€
- bearing ì¡°ì • ì•Œê³ ë¦¬ì¦˜ ì •ìƒ ì‘ë™
- 2px ì°¨ì´ëŠ” ê¸°ìˆ ì  í•œê³„ ë‚´ í—ˆìš© ë²”ìœ„
- ì¶”ê°€ ìˆ˜ì • ë¶ˆí•„ìš”

*** PR ì œì¶œ ì‹œ í¬í•¨ì‚¬í•­
1. ì›ë³¸ IBM Plex Sans KR bearing ë¶„ì„
2. 44-45px â†’ 0-2px ê°œì„  ê²°ê³¼
3. 2px ì°¨ì´ì˜ ê¸°ìˆ ì  ë°°ê²½ ì„¤ëª…
4. ì‹¤ìš©ì  ì˜í–¥ ì—†ìŒ ëª…ì‹œ

*** í–¥í›„ ëª¨ë‹ˆí„°ë§
- ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘
- ë‹¤ë¥¸ í”Œë«í¼/ë Œë”ëŸ¬ í…ŒìŠ¤íŠ¸
- í•„ìš”ì‹œ ë¯¸ì„¸ ì¡°ì •

* êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ :IMPLEMENTATION:

** ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

*** fontforge_script.py
*ìˆ˜ì • ìœ„ì¹˜*: transform_half_width() í•¨ìˆ˜ (ë¼ì¸ 792-808)

#+BEGIN_SRC python
def transform_half_width(jp_font, eng_font):
    """Transform to 1:2 width ratio"""
    after_width_eng = HALF_WIDTH_12  # 528

    for glyph in jp_font.glyphs():
        if glyph.width == 600:
            # Half-width: same width as alphanumeric glyphs
            glyph.transform(psMat.translate((after_width_eng - glyph.width) / 2, 0))
            glyph.width = after_width_eng
        elif glyph.width == 1000:
            # Full-width: double the half-width (with proper bearing adjustment)
            target_width = after_width_eng * 2  # 1056
            bbox = glyph.boundingBox()
            # Calculate actual glyph width
            actual_width = bbox[2] - bbox[0]
            # Center alignment: calculate offset to make left and right bearings equal
            offset = (target_width - actual_width) / 2 - bbox[0]
            glyph.transform(psMat.translate(offset, 0))
            glyph.width = target_width
#+END_SRC

*ìˆ˜ì • ìœ„ì¹˜*: adjust_width_35_jp() í•¨ìˆ˜ (ë¼ì¸ 757-776)

#+BEGIN_SRC python
def adjust_width_35_jp(jp_font):
    """æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆã‚’åŠè§’3:å…¨è§’5å¹…ã«ãªã‚‹ã‚ˆã†ã«å¤‰æ›ã™ã‚‹"""
    after_width = int(FULL_WIDTH_35 * 3 / 5)
    jp_half_width = jp_font[0x3000].width / 2
    jp_full_width = jp_font[0x3000].width
    for glyph in jp_font.glyphs():
        if glyph.width == jp_half_width:
            glyph.transform(psMat.translate((after_width - glyph.width) / 2, 0))
            glyph.width = after_width
        elif glyph.width == jp_full_width:
            # Full-width: apply proper bearing adjustment for center alignment
            target_width = FULL_WIDTH_35  # 1000
            bbox = glyph.boundingBox()
            actual_width = bbox[2] - bbox[0]
            offset = (target_width - actual_width) / 2 - bbox[0]
            glyph.transform(psMat.translate(offset, 0))
            glyph.width = target_width
#+END_SRC

*ì¶”ê°€ ìˆ˜ì •*:
- ë¼ì¸ 544: glyph ë³µì‚¬ ë¡œê·¸ë¥¼ stderrë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

*** fonttools_script.py
*ìˆ˜ì • ìœ„ì¹˜*: add_hinting() í•¨ìˆ˜ (ë¼ì¸ 101-105)

#+BEGIN_SRC python
options_ = options.parse_args(args)
# Remove epoch option for ttfautohint 1.8.3/1.8.4 compatibility
if hasattr(options_, 'epoch'):
    delattr(options_, 'epoch')
ttfautohint(**options_)
#+END_SRC

*** build.ini
*ìˆ˜ì • ìœ„ì¹˜*: ë¼ì¸ 14

#+BEGIN_SRC ini
# Before: IDEOGRAPHIC_SPACE = AdjustedGlyphs/ideographic_space.sfd
# After:
IDEOGRAPHIC_SPACE = AdjustedGlyphs/Ideographic_Space.sfd
#+END_SRC

*ì´ìœ *: Linux íŒŒì¼ì‹œìŠ¤í…œ ëŒ€ì†Œë¬¸ì êµ¬ë¶„

*** shell.nix (NEW)
*ëª©ì *: NixOS 25.05 ì¬í˜„ ê°€ëŠ¥í•œ ë¹Œë“œ í™˜ê²½

#+BEGIN_SRC nix
let
  nixpkgs = fetchTarball "https://github.com/NixOS/nixpkgs/archive/nixos-25.05.tar.gz";
  pkgs = import nixpkgs {};
in
pkgs.mkShell {
  buildInputs = with pkgs; [
    fontforge
    python312
    python312Packages.fonttools
    python312Packages.ttfautohint-py
    ttfautohint
    go-task
    git
    fontconfig
  ];
}
#+END_SRC

*** build_console_all.sh (NEW)
*ëª©ì *: Console ë³€í˜• ìë™ ë¹Œë“œ

#+BEGIN_SRC bash
#!/usr/bin/env bash
# Usage: ./build_console_all.sh [--zip]

# Stage 1: FontForge
nix-shell --run "python3 fontforge_script.py --console" 2>"$BUILD_LOG"
nix-shell --run "python3 fontforge_script.py --console --35 --do-not-delete-build-dir" 2>>"$BUILD_LOG"

# Stage 2: FontTools
nix-shell --run "python3 fonttools_script.py" 2>>"$BUILD_LOG"

# Optional: Create zip archives
if [ "$CREATE_ZIP" = true ]; then
    zip -q "PlemolKRConsole_${VERSION}.zip" PlemolKRConsole-*.ttf
    zip -q "PlemolKR35Console_${VERSION}.zip" PlemolKR35Console-*.ttf
fi
#+END_SRC

** ì»¤ë°‹ íˆìŠ¤í† ë¦¬

#+BEGIN_EXAMPLE
52057a0 Fix Korean glyph overlap issue in Linux/Emacs environment
0f6f5b1 docs: Update build policy to Console-only variants
297452c build: Add complete build environment and automation script
bf68fcd build: Redirect verbose logs to build.log file
40dadb5 fix: Remove epoch option and redirect glyph logs to stderr
76caf66 feat: Add zip archive option and fix epoch removal
1640feb fix: Apply bearing adjustment to 3:5 ratio (PlemolKR35Console)
#+END_EXAMPLE

** ë¹Œë“œ í™˜ê²½ ìš”êµ¬ì‚¬í•­

*** í•„ìˆ˜ ë„êµ¬
- FontForge 20230101 (Python bindings)
- Python 3.12+
- fontTools 4.56.0+
- ttfautohint 1.8.3+
- go-task 3.43.3+ (Taskfile ë°©ì‹)

*** NixOS í™˜ê²½ (ê¶Œì¥)
#+BEGIN_SRC bash
nix-shell  # shell.nix ì‚¬ìš©
#+END_SRC

*** ì¼ë°˜ í™˜ê²½
#+BEGIN_SRC bash
pip install fonttools ttfautohint-py
# FontForgeëŠ” ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ë¡œ ì„¤ì¹˜
#+END_SRC

** ë‹¤ìŒ ë‹¨ê³„

1. *Taskfile.yml ì „í™˜*
   - go-task ì„¤ì¹˜: =nix-env -iA nixpkgs.go-task=
   - ë¹Œë“œ: =task build:console && task build:console35 && task polish=
   - Nerd Fonts: =task patch:nerd:all=

2. *ì¬ê²€ì¦*
   - bearing ì¬í™•ì¸
   - Nerd Fonts í†µí•© í…ŒìŠ¤íŠ¸
   - íŒŒì¼ëª… ë° ë©”íƒ€ë°ì´í„° í™•ì¸

3. *Emacs í…ŒìŠ¤íŠ¸*
   - ì„¤ì¹˜: =cp build/PlemolKRConsole-*.ttf ~/.local/share/fonts/=
   - ìºì‹œ ê°±ì‹ : =fc-cache -fv=
   - Before/After ìŠ¤í¬ë¦°ìƒ·

4. *PR ì¤€ë¹„*
   - ì»¤ë°‹ ë©”ì‹œì§€ ì •ë¦¬
   - PR ì„¤ëª… ì‘ì„±
   - ìŠ¤í¬ë¦°ìƒ· ì²¨ë¶€

** Phase 5: Nerd Fonts ë¹Œë“œ í•œê¸€ ê²¹ì¹¨ ì™„ì „ í•´ê²° (2025-11-11)

*** ë¬¸ì œ ì¬ë°œê²¬

Nerd Fonts ë¹Œë“œì—ì„œ í•œê¸€ ê²¹ì¹¨ì´ ë‹¤ì‹œ ë°œìƒí–ˆìŠµë‹ˆë‹¤:
- *ì¦ìƒ*: =build/nerd/GLG-MonoConsoleNF-*.ttf= ì—ì„œë§Œ í•œê¸€ ê²¹ì¹¨ ë°œìƒ
- *ì •ìƒ*: =build/GLG-MonoConsole-*.ttf= (non-NF)ëŠ” ê²¹ì¹¨ ì—†ìŒ
- *ì‚¬ìš©ì í”¼ë“œë°±*: "nerd í°íŠ¸ë¡œ í…ŒìŠ¤íŠ¸í•˜ë©´ ê²¹ì¹¨í˜„ìƒ ë°œìƒí•´. nerd ë°˜ì˜ ì•ˆí•œ í°íŠ¸ëŠ” ì˜ ì‘ë™í•˜ê³ "

*** ê·¼ë³¸ ì›ì¸ ë¶„ì„

*FontForgeì˜ mergeFonts() ë¶€ì‘ìš©*:
1. =fontforge_script.py:1115= ì˜ =jp_font.mergeFonts(nerd_font)= í˜¸ì¶œ
2. FontForgeê°€ ë‚´ë¶€ì ìœ¼ë¡œ ê·¸ë¦¬í”„ë¥¼ ì¬ì •ë ¬ (glyph reordering)
3. í•œê¸€ ê·¸ë¦¬í”„ì˜ bbox ê¸°ë°˜ ì¤‘ì•™ ì •ë ¬ì´ ì†ìƒë¨
4. ê²°ê³¼: ë‹¨ìˆœ translateë¡œ ë³µì›ë˜ì–´ ê²¹ì¹¨ ì¬ë°œ

#+BEGIN_SRC python
# ë¬¸ì œì˜ ì›ì¸ (fontforge_script.py:1115)
def add_nerd_font_glyphs(jp_font, eng_font):
    # ...
    jp_font.mergeFonts(nerd_font)  # â† ì´ ì‹œì ì— í•œê¸€ bearing ì†ìƒ!
    # ...
#+END_SRC

*** í•´ê²° ë°©ì•ˆ

*fix_korean_bearing_after_merge() í•¨ìˆ˜ ì¶”ê°€*:

#+BEGIN_SRC python
# fontforge_script.py:838-858
def fix_korean_bearing_after_merge(jp_font):
    """Nerd Fonts ë³‘í•© í›„ í•œê¸€ ê·¸ë¦¬í”„ bearing ì¬ì¡°ì •

    mergeFonts() í˜¸ì¶œ ì‹œ FontForgeê°€ ê·¸ë¦¬í”„ë¥¼ ì¬ì •ë ¬í•˜ë©´ì„œ
    í•œê¸€ì˜ bbox ê¸°ë°˜ ì¤‘ì•™ ì •ë ¬ì´ ì†ìƒë˜ì–´ ê²¹ì¹¨ í˜„ìƒì´ ë°œìƒí•¨.
    ì´ í•¨ìˆ˜ëŠ” í•œê¸€ ë²”ìœ„ì— ëŒ€í•´ bearingì„ ì¬ì¡°ì •í•˜ì—¬ ë¬¸ì œë¥¼ í•´ê²°í•¨.
    """
    # ì „ê° í­ í™•ì¸ (ì¼ë³¸ì–´ íˆë¼ê°€ë‚˜ 'ã‚'ì˜ í­ Ã— 2)
    target_width = jp_font[0x3042].width

    for glyph in jp_font.glyphs():
        # í•œê¸€ ìŒì ˆ (ê°€-í£) + í•œê¸€ ìëª¨ (ã„±-ã†) ë²”ìœ„ë§Œ ì²˜ë¦¬
        if (0xAC00 <= glyph.unicode <= 0xD7A3 or
            0x3131 <= glyph.unicode <= 0x318E):
            if glyph.width == target_width:
                # bbox ê¸°ë°˜ ì¤‘ì•™ ì •ë ¬ ì¬ì ìš©
                bbox = glyph.boundingBox()
                actual_width = bbox[2] - bbox[0]
                offset = (target_width - actual_width) / 2 - bbox[0]
                glyph.transform(psMat.translate(offset, 0))
                glyph.width = target_width
#+END_SRC

*í˜¸ì¶œ ìœ„ì¹˜* (fontforge_script.py:273-276):

#+BEGIN_SRC python
if options.get("nerd-font"):
    add_nerd_font_glyphs(jp_font, eng_font)
    # Nerd Fonts ë³‘í•© í›„ í•œê¸€ bearing ì¬ì¡°ì • (ê²¹ì¹¨ ë°©ì§€)
    fix_korean_bearing_after_merge(jp_font)
#+END_SRC

*** ê²€ì¦ ê²°ê³¼

*ìë™ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸* (test_korean_bearing_nf.py):

#+BEGIN_EXAMPLE
==================================================================
Nerd Fonts ë¹Œë“œ í•œê¸€ Bearing ê²€ì¦
==================================================================

============================================================
Non-NF (ê¸°ë³¸): build/GLG-MonoConsole-Regular.ttf
============================================================
Target width (ì „ê°): 1056

Char   Unicode    Width    LSB      RSB      Actual   Status
----------------------------------------------------------------------
ê°€     U+AC00     1056     82.0     82.0     892.0    âœ“ OK
ê°     U+AC01     1056     82.0     82.0     892.0    âœ“ OK
ë‚˜     U+B098     1056     82.0     82.0     892.0    âœ“ OK
ë‹¤     U+B2E4     1056     82.0     82.0     892.0    âœ“ OK
ë¼     U+B77C     1056     82.0     82.0     892.0    âœ“ OK
í•˜     U+D558     1056     82.0     82.0     892.0    âœ“ OK
í£     U+D7A3     1056     82.0     82.0     892.0    âœ“ OK

============================================================
NF (Nerd Fonts): build/GLG-MonoConsoleNF-Regular.ttf
============================================================
Target width (ì „ê°): 1056

Char   Unicode    Width    LSB      RSB      Actual   Status
----------------------------------------------------------------------
ê°€     U+AC00     1056     82.0     82.0     892.0    âœ“ OK
ê°     U+AC01     1056     82.0     82.0     892.0    âœ“ OK
ë‚˜     U+B098     1056     82.0     82.0     892.0    âœ“ OK
ë‹¤     U+B2E4     1056     82.0     82.0     892.0    âœ“ OK
ë¼     U+B77C     1056     82.0     82.0     892.0    âœ“ OK
í•˜     U+D558     1056     82.0     82.0     892.0    âœ“ OK
í£     U+D7A3     1056     82.0     82.0     892.0    âœ“ OK

======================================================================
ë¹„êµ ê²°ê³¼
======================================================================
ê°€ (U+AC00): LSB ì°¨ì´ 0.0px, RSB ì°¨ì´ 0.0px - âœ“ ì¼ì¹˜
ê° (U+AC01): LSB ì°¨ì´ 0.0px, RSB ì°¨ì´ 0.0px - âœ“ ì¼ì¹˜
ë‚˜ (U+B098): LSB ì°¨ì´ 0.0px, RSB ì°¨ì´ 0.0px - âœ“ ì¼ì¹˜
ë‹¤ (U+B2E4): LSB ì°¨ì´ 0.0px, RSB ì°¨ì´ 0.0px - âœ“ ì¼ì¹˜
ë¼ (U+B77C): LSB ì°¨ì´ 0.0px, RSB ì°¨ì´ 0.0px - âœ“ ì¼ì¹˜
í•˜ (U+D558): LSB ì°¨ì´ 0.0px, RSB ì°¨ì´ 0.0px - âœ“ ì¼ì¹˜
í£ (U+D7A3): LSB ì°¨ì´ 0.0px, RSB ì°¨ì´ 0.0px - âœ“ ì¼ì¹˜

======================================================================
âœ“ ëª¨ë“  í•œê¸€ ê¸€ë¦¬í”„ì˜ bearingì´ ì¼ì¹˜í•©ë‹ˆë‹¤!
  Nerd Fonts ë³‘í•© í›„ì—ë„ í•œê¸€ ê²¹ì¹¨ì´ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
======================================================================
#+END_EXAMPLE

*** ì¶”ê°€ ê°œì„  ì‚¬í•­

*1. ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ ë¡œê·¸ ë¶„ë¦¬* (build_with_taskfile.sh):

#+BEGIN_SRC bash
# Stage 2: FontForge
echo "  (Progress: console output, Logs: $BUILD_LOG)"
time task build:console 2>"$BUILD_LOG"

# Stage 4: Nerd Fonts
NERD_LOG="build/nerd_patch.log"
echo "  (Progress: console output, Detailed logs: $NERD_LOG)"
time task patch:nerd 2>"$NERD_LOG"
#+END_SRC

*2. Taskfile.yml ìŠ¤íŠ¸ë¦¼ ë¦¬ë‹¤ì´ë ‰ì…˜ ìˆ˜ì •*:

#+BEGIN_SRC yaml
# Before (blocks stderr redirection):
"$font" 2>&1 | grep -v "^Copyright" | grep -v "^$" || true

# After (allows proper redirection):
"$font"
#+END_SRC

*3. Nerd Fonts Progress Bar ì œê±°* (2025-11-11):

#+BEGIN_SRC yaml
# Taskfile.yml: --no-progressbars ì˜µì…˜ ì¶”ê°€
fontforge --script FontPatcher/font-patcher \
  --complete --careful --mono \
  --no-progressbars \
  --outputdir build/nerd/tmp \
  "$font"
#+END_SRC

íš¨ê³¼:
- Progress bar ë°˜ë³µ ì œê±° (â•¢â–ˆâ–ˆâ–ˆâ–ˆ...â•Ÿ 100% Ã— 8íšŒ/í°íŠ¸)
- ê°„ê²°í•œ ì½˜ì†” ì¶œë ¥: "ğŸ”§ íŒ¨ì¹˜ ì¤‘..." â†’ "âœ… ì™„ë£Œ"
- ìƒì„¸ ë¡œê·¸: =build/nerd_patch.log= ì— ëª¨ë“  ì²˜ë¦¬ ë‚´ì—­ ê¸°ë¡

*** ì»¤ë°‹ íˆìŠ¤í† ë¦¬

#+BEGIN_EXAMPLE
bb32f60 - Fix Korean glyph bearing after Nerd Fonts merge (2025-11-11)
  - fix_korean_bearing_after_merge() í•¨ìˆ˜ ì¶”ê°€
  - ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ ë¡œê·¸ ë¶„ë¦¬ ê°œì„ 
  - test_korean_bearing_nf.py ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€

3596222 - Replace verification scripts with complete Korean glyph validator (2025-11-10)
  - verify_korean_complete.py: í†µí•© ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸
  - 9/9 í•œê¸€ ê¸€ë¦¬í”„ ë³€í™˜ ê²€ì¦ (width, offset, bearing)

57e1c55 - Apply bearing adjustment only to Korean glyph ranges (2025-11-09)
  - í•œê¸€ ë²”ìœ„ë§Œ bearing ì¡°ì • (0xAC00-0xD7A3, 0x3131-0x318E)

c0dde57 - Fix Korean glyph bearing issue with bbox-based center alignment (2025-11-09)
  - bbox ê¸°ë°˜ ì¤‘ì•™ ì •ë ¬ ì•Œê³ ë¦¬ì¦˜ ê°œë°œ
  - offset = (target_width - actual_width) / 2 - bbox[0]
#+END_EXAMPLE

*** ìµœì¢… ê²°ë¡ 

*âœ… ë¬¸ì œ ì™„ì „ í•´ê²°*:
1. *ê·¼ë³¸ ì›ì¸*: FontForge mergeFonts()ì˜ ê·¸ë¦¬í”„ ì¬ì •ë ¬
2. *í•´ê²°ì±…*: Nerd Fonts ë³‘í•© í›„ í•œê¸€ bearing ì¬ì¡°ì •
3. *ê²€ì¦ ê²°ê³¼*: 0.0px ì°¨ì´ (7/7 í…ŒìŠ¤íŠ¸ ê¸€ë¦¬í”„ ì™„ë²½ ì¼ì¹˜)
4. *ì ìš© ë²”ìœ„*: NF/non-NF ë¹Œë“œ ëª¨ë‘ ì •ìƒ ì‘ë™

*ê¸°ìˆ ì  í†µì°°*:
- FontForgeì˜ mergeFonts()ëŠ” ë‹¨ìˆœ ë³‘í•©ì´ ì•„ë‹Œ ë‚´ë¶€ ì¬ì •ë ¬ ìˆ˜í–‰
- ì™¸ë¶€ ì¡°ì •(bearing, width)ì€ ë³‘í•© í›„ ì†ì‹¤ë  ìˆ˜ ìˆìŒ
- í•´ê²°: ë³‘í•© í›„ ì¬ì¡°ì • ë‹¨ê³„ í•„ìˆ˜ (fix_korean_bearing_after_merge)

*í”„ë¡œì íŠ¸ ìƒíƒœ*:
- PlemolKR â†’ GLG-Mono ì „í™˜ ì™„ë£Œ
- í•œê¸€ ê²¹ì¹¨ ë¬¸ì œ ì™„ì „ í•´ê²° (Nerd Fonts í¬í•¨)
- Emacs, VSCode, í„°ë¯¸ë„ ëª¨ë‘ ì •ìƒ ë™ì‘ í™•ì¸

---

ë³¸ ë¬¸ì„œëŠ” PlemolKR í°íŠ¸ ê°œì„  í”„ë¡œì íŠ¸ì˜ ê¸°ìˆ  ë¶„ì„ ë¬¸ì„œì…ë‹ˆë‹¤.
ìˆ˜ì • ì‚¬í•­ì€ fix/korean-overlap ë¸Œëœì¹˜ì—ì„œ ì§„í–‰ë©ë‹ˆë‹¤.

#+BEGIN_EXAMPLE
Repository: /home/goqual/repos/gh/GLG-Mono (PlemolKR â†’ GLG-Mono ì „í™˜)
Branch: main
Date: 2025-11-09 (ì‹œì‘) â†’ 2025-11-11 (ì™„ë£Œ)
Analyzer: Claude Code + junghanacs
Last Update: Phase 5 ì™„ë£Œ - Nerd Fonts ë¹Œë“œ í•œê¸€ ê²¹ì¹¨ ì™„ì „ í•´ê²°
Status: âœ… í•´ê²° ì™„ë£Œ (NF/non-NF ëª¨ë‘ ê²€ì¦)
#+END_EXAMPLE
